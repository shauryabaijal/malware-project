//
// Created by adhokshajmishra on 29/7/20.
//

#ifndef SANDBOXER_SANDBOXCONTROLLER_H
#define SANDBOXER_SANDBOXCONTROLLER_H

#include <filesystem>
#include "ConfigurationTypes.h"
#include "VBoxManager.h"

class SandboxController {
private:
    VMConfig vm_config;
    SandboxConfig sandbox_config;
    ExecutionConfig exec_config;
    VBoxManager manager;
protected:
    void interim_exec();
public:
    SandboxController(VMConfig vm_config, SandboxConfig sandbox_config, ExecutionConfig exec_config);
    ~SandboxController();
    void runOneSample(std::filesystem::path sample, bool container = false, bool vmcontrol = true);
    void runAllSamples();
};


#endif //SANDBOXER_SANDBOXCONTROLLER_H
