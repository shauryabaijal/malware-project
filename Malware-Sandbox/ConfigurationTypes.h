//
// Created by adhokshajmishra on 29/7/20.
//

#ifndef SANDBOXER_CONFIGURATIONTYPES_H
#define SANDBOXER_CONFIGURATIONTYPES_H

#include <string>
#include <vector>

struct VMConfig
{
    std::string vm_name;
    std::string snapshot_name;
    std::string ip_address;
    int port;
    std::string username;
    std::string password;
    bool is_sudo;
    bool is_sudo_password;
    std::string sudo_password;
    std::string upload_path;

    VMConfig();
};

struct sandbox_command
{
    std::string command;
    bool isSudo;
    int interval;

    sandbox_command();
};

enum MalwareSourceType
{
    folder,
    file_list,
    file_json_db
};

enum FileType
{
    all,
    elf,
    script
};

struct ExecutionConfig
{
    FileType type;
    bool isTrace;
    bool followFork;
    int max_param_length;

    ExecutionConfig();
};

struct SandboxConfig
{
    std::vector<sandbox_command> pre_exec, post_exec;
    sandbox_command interim_exec;
    MalwareSourceType source;
    std::string malware_source_path;
    std::string interim_output;
    std::string execution_ouput;
    SandboxConfig();
};

#endif //SANDBOXER_CONFIGURATIONTYPES_H
