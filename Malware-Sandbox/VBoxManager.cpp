//
// Created by adhokshajmishra on 27/7/20.
//

#include <cstdlib>

#include "VBoxManager.h"

std::vector<std::string> vbox_ui_type = {"gui", "sdl", "headless", "separate"};

VBoxManager::VBoxManager() {

}

VBoxManager::~VBoxManager() {

}

bool VBoxManager::run_command(std::string command) {
    std::string vbox_command("/usr/bin/vboxmanage ");
    vbox_command.append(command);
    this->result = system(vbox_command.c_str());

    if (this->result == -1)
        return false;
    else
        return true;
}

int VBoxManager::startvm(std::string vm_name, VBoxUIType ui_type) {
    std::string sub_command("startvm ");
    sub_command.append(vm_name);
    sub_command.append(" --type ");
    sub_command.append(vbox_ui_type[ui_type]);

    run_command(sub_command);
    return result;
}

int VBoxManager::stopvm(std::string vm_name) {
    std::string sub_command("controlvm ");
    sub_command.append(vm_name);
    sub_command.append(" poweroff");

    run_command(sub_command);
    return result;
}

int VBoxManager::restorevm(std::string vm_name, std::string snapshot_name) {
    std::string sub_command("snapshot ");
    sub_command.append(vm_name);
    sub_command.append(" restore ");
    sub_command.append(snapshot_name);

    run_command(sub_command);
    return result;
}

int main() {return 0;}